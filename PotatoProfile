def load_data(csv_file, start_date, end_date):
    print(f"\n" + "="*80)
    print("STEP 1: LOADING DATA CSV")
    print("="*80)

    ndvi_data = pd.read_csv(csv_file,
                            usecols=['field_id', 'date', 'median'],
                            parse_dates=['date'])

    # Filter by date range
    start_date = pd.to_datetime(start_date)
    end_date = pd.to_datetime(end_date)

    filtered_data = ndvi_data[
        (ndvi_data['date'] >= start_date) &
        (ndvi_data['date'] <= end_date)
    ].copy()

    print(f"  ğŸ“… After date filter: {len(filtered_data):,} rows")
    print(f"  ğŸ“Š Date range: {filtered_data['date'].min()} to {filtered_data['date'].max()}")

    # Sort by field_id and date
    filtered_data = filtered_data.sort_values(['field_id', 'date'])
    print(f"  âœ… Data sorted by field_id and date")

    # Aggregate by field and date (median)
    aggregated_data = filtered_data.groupby(['field_id', 'date']).agg({
        'median': 'median'
    }).reset_index()

    del ndvi_data, filtered_data
    gc.collect()

    return aggregated_data
